<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>×¦×¤×™×™×” ×‘×¢×¨×•×¦×™×</title>
  <!-- Google Analytics Script -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-J5WT91REYB"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-J5WT91REYB');
  </script>
  <!-- HLS.js Library for HLS streams -->
  <script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
  <!-- Tailwind CSS CDN for styling -->
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    /* ×”×’×“×¨×•×ª ×‘×¡×™×¡×™×•×ª ×œ×’×•×£ ×”×“×£ */
    body {
      background: #1F2937; /* ×¨×§×¢ ×›×”×” */
      color: white; /* ×˜×§×¡×˜ ×œ×‘×Ÿ */
      font-family: 'Inter', sans-serif; /* ×¤×•× ×˜ × ×§×™ */
      margin: 0;
    }

    /* ×§×•× ×˜×™×™× ×¨ ×œ×•×™×“××• - ×™×—×¡ ×’×•×‘×”-×¨×•×—×‘ ×§×‘×•×¢, ×¤×™× ×•×ª ××¢×•×’×œ×•×ª */
    .video-container {
      position: relative;
      aspect-ratio: 16/9; /* ×™×—×¡ 16:9 ×œ×•×™×“××• */
      border-radius: 8px; /* ×¤×™× ×•×ª ××¢×•×’×œ×•×ª */
      overflow: hidden; /* ×”×¡×ª×¨×ª ×ª×•×›×Ÿ ×©×™×•×¦× ××’×‘×•×œ×•×ª */
    }

    /* ×§×•× ×˜×™×™× ×¨ ×œ×›×¤×ª×•×¨×™ ×©×œ×™×˜×” (×”×©×ª×§/××¡×š ××œ×) */
    .controls-container {
      position: absolute;
      top: 50%;
      left: 12px;
      transform: translateY(-50%);
      display: flex;
      flex-direction: column;
      gap: 10px;
      align-items: flex-start;
      z-index: 10; /* ×•×“× ×©×”×¤×§×“×™× × ××¦××™× ××¢×œ ×”×•×™×“××• */
      opacity: 0; /* ×›×‘×¨×™×¨×ª ××—×“×œ ×”×›×¤×ª×•×¨×™× ×¢××•××™× */
      transition: opacity 0.3s ease; /* ×× ×™××¦×™×” ×—×œ×§×” ×œ××¢×‘×¨ ×©×§×™×¤×•×ª */
    }

    /* ×”×¦×’×ª ×›×¤×ª×•×¨×™ ×”×©×œ×™×˜×” ×‘××¢×‘×¨ ×¢×›×‘×¨/××’×¢ */
    .video-container:hover .controls-container,
    .video-container.touch-active .controls-container { /* 'touch-active' for mobile touch */
      opacity: 1; /* ×”×¦×’ ××ª ×”×›×¤×ª×•×¨×™× ×‘××¢×‘×¨ ×¢×›×‘×¨ */
    }

    /* ×¤×¡ ×©× ×”×¢×¨×•×¥ ×”×¢×œ×™×•×Ÿ */
    .channel-name-bar {
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      background: rgba(0,0,0,0.7); /* ×¨×§×¢ ×©×§×•×£ ×œ××—×¦×” */
      color: white;
      padding: 4px 10px;
      text-align: center;
      font-size: 0.85rem;
      border-bottom-left-radius: 8px;
      border-bottom-right-radius: 8px;
      opacity: 0; /* ×›×‘×¨×™×¨×ª ××—×“×œ ×¢××•× */
      transition: opacity 0.3s ease; /* ×× ×™××¦×™×” ×—×œ×§×” ×œ××¢×‘×¨ ×©×§×™×¤×•×ª */
      z-index: 10; /* ××¢×œ ×”×•×™×“××• */
    }

    /* ×”×¦×’×ª ×¤×¡ ×©× ×”×¢×¨×•×¥ ×‘××¢×‘×¨ ×¢×›×‘×¨/××’×¢ */
    .video-container:hover .channel-name-bar,
    .video-container.touch-active .channel-name-bar {
      opacity: 1;
    }

    /* ×¡×’× ×•×Ÿ ×›×œ×œ×™ ×œ×›×¤×ª×•×¨×™ ×¡××•× ×“ ×•××¡×š ××œ× */
    .sound-toggle, .fullscreen-toggle {
      display: flex;
      justify-content: center;
      align-items: center;
      background: rgba(0,0,0,0.6); /* ×¨×§×¢ ×©×§×•×£ ×œ××—×¦×” */
      padding: 8px 16px;
      border-radius: 10px; /* ×¤×™× ×•×ª ××¢×•×’×œ×•×ª ×™×•×ª×¨ */
      cursor: pointer; /* ×¡××Ÿ ×¢×›×‘×¨ ×›×”×¦×‘×¢×” */
      font-size: 0.9rem;
      min-width: 90px;
      text-align: center;
      transition: 0.2s ease; /* ×× ×™××¦×™×™×ª ××¢×‘×¨ ×§×¦×¨×” */
      color: white;
    }

    /* ×¦×‘×¢×™× ×œ×›×¤×ª×•×¨ ×¡××•× ×“ ×‘×”×ª×× ×œ××¦×‘ */
    .sound-toggle.on { background: #10B981; } /* ×™×¨×•×§ ×›×©×”×¡××•× ×“ ×¤×¢×™×œ */
    .sound-toggle.off { background: #EF4444; } /* ××“×•× ×›×©×”×¡××•× ×“ ××•×©×ª×§ */

    /* ×¦×‘×¢×™× ×œ×›×¤×ª×•×¨ ××¡×š ××œ× ×‘×”×ª×× ×œ××¦×‘ */
    .fullscreen-toggle { background: #4B5563; } /* ××¤×•×¨ ×›×”×” */
    .fullscreen-toggle.active { background: #4F46E5; } /* ×›×—×•×œ-×¡×’×•×œ ×›×©×”××¡×š ××œ× ×¤×¢×™×œ */

    /* ×¡×’× ×•×Ÿ ×›×¤×ª×•×¨×™ ×‘×—×™×¨×ª ×¢×¨×•×¥ */
    .channel-button {
       padding: 10px 20px;
       border-radius: 8px;
       background: #4B5563; /* ××¤×•×¨ ×›×”×” */
       transition: 0.2s; /* ×× ×™××¦×™×™×ª ××¢×‘×¨ ×§×¦×¨×” */
       font-weight: bold;
       display: flex;
       align-items: center;
       gap: 8px; /* ×¨×•×•×— ×‘×™×Ÿ ××™×™×§×•×Ÿ ×œ×˜×§×¡×˜ */
    }
    .channel-button:hover { background: #6B7280; } /* ×¨×§×¢ ×›×”×” ×™×•×ª×¨ ×‘××¢×‘×¨ ×¢×›×‘×¨ */
    .channel-button.active { background: #1F6FEB; transform: translateY(-2px); } /* ×›×—×•×œ ×›×©×”×¢×¨×•×¥ ×¤×¢×™×œ, ×¢× ××¤×§×˜ ×§×˜×Ÿ */

    /* ××“×™×” ×§×•×•××¨×™×¡ ×œ×¨×©×ª ×•×™×“××• - ×œ××¡×›×™× ×’×“×•×œ×™× */
    @media (min-width: 768px) {
      /* ×”×’×“×¨×ª ×”×’×¨×™×“ ×œ-3 ×¢××•×“×•×ª ×©×•×•×ª ×¨×•×—×‘ */
      #video-grid {
        grid-template-columns: repeat(3, 1fr); /* 3 ×¢××•×“×•×ª ×©×•×•×ª */
        grid-auto-rows: auto;
      }
    }
    /* ×œ×¨×•×—×‘ ×§×˜×Ÿ ×™×•×ª×¨, ×”×’×¨×™×“ ×™×”×™×” ×¢××•×“×” ××—×ª ×›×¤×™ ×©×”×•×’×“×¨ ×‘-Tailwind: grid-cols-1 */

    /* ××¦×‘ ××¡×š ××œ× - ×”×¡×ª×¨×ª ×©××¨ ×”×•×™×“××•×™× */
    .fullscreen-mode .video-container:not(.active-fullscreen) {
      display: none !important;
    }

    /* ×¡×’× ×•×Ÿ ×”×•×™×“××• ×”×¤×¢×™×œ ×‘××¦×‘ ××¡×š ××œ× */
    .fullscreen-mode .video-container.active-fullscreen {
      position: fixed; /* ×§×‘×•×¢ ×‘××™×§×•× ×”××¡×š */
      top: 0;
      left: 0;
      width: 100vw !important; /* ×¨×•×—×‘ ××¡×š ××œ× */
      height: 100vh !important; /* ×’×•×‘×” ××¡×š ××œ× */
      z-index: 9999; /* ××¢×œ ×”×›×œ */
      background: #000; /* ×¨×§×¢ ×©×—×•×¨ */
      border-radius: 0; /* ×œ×œ× ×¤×™× ×•×ª ××¢×•×’×œ×•×ª */
      opacity: 0; /* ×”×ª×—×œ×” ××©×§×™×¤×•×ª 0 */
      animation: fadeIn 0.3s ease forwards; /* ×× ×™××¦×™×™×ª ×”×•×¤×¢×” ×¢×“×™× ×” */
    }

    /* ×× ×™××¦×™×™×ª ×”×•×¤×¢×” ×œ××¡×š ××œ× */
    @keyframes fadeIn {
      from { opacity: 0; }
      to { opacity: 1; }
    }

    /* ×× ×™××¦×™×•×ª ×”×—×œ×§×” ×‘×™×Ÿ ×•×™×“××•×™× ×‘××¦×‘ ××¡×š ××œ× */
    .slide-left {
      animation: slideLeft 0.3s ease forwards;
    }
    .slide-right {
      animation: slideRight 0.3s ease forwards;
    }
    @keyframes slideLeft {
      from { transform: translateX(100px); opacity: 0; }
      to { transform: translateX(0); opacity: 1; }
    }
    @keyframes slideRight {
      from { transform: translateX(-100px); opacity: 0; }
      to { transform: translateX(0); opacity: 1; }
    }
  </style>
</head>
<body class="p-4">
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-P5QLH7TD" height="0" width="0" style="display:none"></iframe></noscript>

<h1 class="text-2xl font-bold text-center mb-4">×¦×¤×™×™×” ×‘×¢×¨×•×¦×™×</h1>

<div class="flex justify-center gap-3 flex-wrap mb-6" id="channel-buttons">
  <button class="channel-button" data-channel="kan11">×›××Ÿ 11</button>
  <button class="channel-button" data-channel="now14">×¢×›×©×™×• 14</button>
  <button class="channel-button" data-channel="i24news">i24NEWS</button>
  <button class="channel-button" data-channel="news13">×—×“×©×•×ª 13</button>
  <button class="channel-button" data-channel="news12">×—×“×©×•×ª 12</button>
</div>

<div id="video-grid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
  <!-- ×¡×¨×˜×•× ×™ ×”×¢×¨×•×¦×™× ×™×•×¦×’×• ×›××Ÿ ×¢×œ ×™×“×™ JavaScript -->
</div>

<p id="no-channel-message" class="text-center text-gray-300 mt-6 hidden">×™×© ×œ×‘×—×•×¨ ×¢×¨×•×¥ ××”×›×¤×ª×•×¨×™× ××¢×œ×”</p>

<script>
  // ×”×’×“×¨×ª ×”×¢×¨×•×¦×™× ×”×–××™× ×™×, ×›×•×œ×œ ×¡×•×’ ×•×™×“××• (hls/iframe) ×•×›×ª×•×‘×ª URL
  const channels = {
    kan11: { name: '×›××Ÿ 11', type: 'hls', url: 'https://kan11w.media.kan.org.il/hls/live/2105694/2105694/source1_4k/chunklist.m3u8' },
    now14: {
      name: '×¢×›×©×™×• 14',
      type: 'iframe',
      url: 'https://snippet.univtec.com/player.html?data-insight=eyJndWlkIjoiYjY3NmI5MDYtNTYyNS00OGFmLWEzMzEtMTFhNWQyMmUxNTFiIiwidHlwZSI6ImNoYW5uZWxzIiwiYWNjb3VudElkIjoiNjM5Nzc1M2ZmZjg3MTk3YWU2YTNjMDMiLCJjbGllbnQiOiJjaGFubmVsMTQiLCJhcGkiOiJodHRwczovL2luc2lnaHQtYXBpLWNoYW5uZWwxNC51bml2dGVjLmNvbS8ifQ==',
      muteParam: 'muted' // ×¤×¨××˜×¨ ×”×©×ª×§×” ×× ×§×™×™× ×‘× ×’×Ÿ iframe
    },
    i24news: { name: 'i24NEWS', type: 'hls', url: 'https://bcovlive-a.akamaihd.net/d89ede8094c741b7924120b27764153c/eu-central-1/5377161796001/profile_0/chunklist.m3u8' },
    news13: { name: '×—×“×©×•×ª 13', type: 'hls', url: 'https://d198ztbnlup2iq.cloudfront.net/out/v1/2d9050c90fb94df8b78d1d98306a1a65/index.m3u8' },
    news12: {
      name: '×—×“×©×•×ª 12',
      type: 'iframe',
      url: 'https://www.mako.co.il/AjaxPage?jspName=embedHTML5video.jsp&galleryChannelId=798cfb1e06667910VgnVCM200000650a10acRCRD&videoChannelId=7690b3a2a4ac5910VgnVCM200000650a10acRCRD&vcmid=003432e70df02310VgnVCM100000290b320aRCRD',
      muteParam: 'muted'
    }
  };

  // ××©×ª× ×™ ××¦×‘ ×’×œ×•×‘×œ×™×™×
  let active = []; // ×¨×©×™××ª ×”×¢×¨×•×¦×™× ×”×¤×¢×™×œ×™× (×©× ×‘×—×¨×• ×œ×¦×¤×™×™×”)
  let activeAudioKey = null; // ××–×”×” ×”×¢×¨×•×¥ ×”×¤×¢×™×œ ×¢× ×©××¢
  let fullscreenKey = null; // ××–×”×” ×”×¢×¨×•×¥ ×©× ××¦× ×›×¨×’×¢ ×‘××¡×š ××œ×
  let lastDirection = null; // ×¢×•×§×‘ ××—×¨ ×›×™×•×•×Ÿ ×”×”×—×œ×§×”/×—×¥ ×œ××˜×¨×ª ×× ×™××¦×™×”

  // ××œ×× ×˜×™× ××”-DOM
  const grid = document.getElementById('video-grid');
  const message = document.getElementById('no-channel-message');
  const channelButtonsContainer = document.getElementById('channel-buttons');

  /**
   * ×‘×•× ×” ×›×ª×•×‘×ª URL ×œ-iframe ×¢× ×¤×¨××˜×¨×™× ×©×œ ×”×©×ª×§×”.
   * ×¤×¨××˜×¨ autoplay ×”×•×¡×¨ ××›×™×•×•×Ÿ ×©×”×•× ××˜×•×¤×œ ×¢"×™ allow="autoplay" ×‘-iframe.
   * @param {string} base - ×›×ª×•×‘×ª ×”-URL ×”×‘×¡×™×¡×™×ª.
   * @param {boolean} muted - ×”×× ×œ×”×©×ª×™×§ ××ª ×”×•×™×“××•.
   * @param {string} muteParam - ×©× ×”×¤×¨××˜×¨ ×œ×©×œ×™×˜×” ×‘×”×©×ª×§×” ×‘-URL.
   * @returns {string} ×›×ª×•×‘×ª URL ××¢×•×“×›× ×ª.
   */
  function buildUrl(base, muted, muteParam = 'muted') {
    const url = new URL(base);
    // ×”×•×¡×£ ××ª ×¤×¨××˜×¨ ×”×”×©×ª×§×” ×¨×§ ×× ×”×•× ××•×’×“×¨ ×¢×‘×•×¨ ×”×¢×¨×•×¥
    if (muteParam) {
      url.searchParams.set(muteParam, muted ? '1' : '0');
    }
    return url.toString();
  }

  /**
   * ××¤×¢×™×œ ××• ××›×‘×” ××¦×‘ ××¡×š ××œ× ×¢×‘×•×¨ ×•×™×“××• ××¡×•×™×.
   * @param {string} key - ××–×”×” ×”×¢×¨×•×¥.
   */
  function toggleFullscreen(key) {
    if (fullscreenKey === key) {
      // ×× ×›×‘×¨ ×‘××¡×š ××œ×, ×¦× ×××¦×‘ ××¡×š ××œ×
      fullscreenKey = null;
      document.body.classList.remove('fullscreen-mode');
      document.exitFullscreen?.(); // ×™×¦×™××” ×××¡×š ××œ× ×‘×“×¤×“×¤×Ÿ
    } else {
      // ×× ×œ× ×‘××¡×š ××œ×, ×”×™×›× ×¡ ×œ××¦×‘ ××¡×š ××œ×
      fullscreenKey = key;
      activeAudioKey = key; // ×”×¢×¨×•×¥ ×‘××¡×š ××œ× ×ª××™×“ ×™×”×™×” ×¢× ×©××¢
      document.body.classList.add('fullscreen-mode');
      document.documentElement.requestFullscreen?.().catch(err => {
        console.log('Fullscreen error:', err); // ×”×“×¤×¡×ª ×©×’×™××•×ª ×‘××¡×š ××œ×
      });
    }
    render(); // ×¨× ×“×•×¨ ××—×“×© ×©×œ ×”×•×™×“××•×™×
  }

  /**
   * ××¢×“×›×Ÿ ××ª ×›×¤×ª×•×¨×™ ×‘×—×™×¨×ª ×”×¢×¨×•×¥ ×›×“×™ ×œ×”×¦×™×’ ××™× ×“×™×§×˜×•×¨ ×©××¢ ×¤×¢×™×œ ×•××ª ×”×¢×¨×•×¦×™× ×”×¤×¢×™×œ×™×.
   */
  function updateChannelButtons() {
    document.querySelectorAll('.channel-button').forEach(btn => {
      const key = btn.dataset.channel;
      // ×”×¡×¨ ××ª ×›×œ ××™×™×§×•× ×™ ×”×¢×¨×•×¥ ×”×§×™×™××™× (×¤×¢×™×œ/×©××¢)
      btn.querySelectorAll('.channel-icon').forEach(icon => icon.remove());

      // ×× ×”×¢×¨×•×¥ ×¤×¢×™×œ, ×”×•×¡×£ ××™×™×§×•×Ÿ ××ª××™×
      if (active.includes(key)) {
        const icon = document.createElement('span');
        icon.className = 'channel-icon ml-1'; // ×§×œ××¡ ×›×œ×œ×™ ×œ××™×™×§×•×Ÿ ×¢× ×¨×•×•×—

        if (key === activeAudioKey) {
          icon.textContent = 'ğŸ”Š'; // ××™×™×§×•×Ÿ ×©××¢
        } else {
          icon.textContent = 'âœ…'; // ××™×™×§×•×Ÿ ×•×™ (×¤×¢×™×œ)
        }
        btn.appendChild(icon); // ×”×•×¡×£ ××ª ×”××™×™×§×•×Ÿ ×œ×›×¤×ª×•×¨
      }
    });
  }

  /**
   * ××¨× ×“×¨ ××—×“×© ××ª ×¨×©×ª ×”×•×™×“××• ×‘×”×ª×× ×œ×¢×¨×•×¦×™× ×”×¤×¢×™×œ×™×.
   */
  function render() {
    grid.innerHTML = ''; // × ×§×” ××ª ×”×¨×©×ª ×”×§×™×™××ª
    // ×”×’×“×¨ ××ª ×”×’×¨×™×“ ×œ-1 ×¢××•×“×” ×‘××•×‘×™×™×œ, ×•-3 ×¢××•×“×•×ª ×‘××¡×›×™× ×’×“×•×œ×™× ×™×•×ª×¨
    // ×–×” ×™×‘×˜×™×— ×¡×™××˜×¨×™×” ×‘×’×•×“×œ ×œ×›×œ ×›××•×ª ×©×œ ×¡×¨×˜×•× ×™× (×¢×“ 3 ×‘×©×•×¨×”)
    grid.className = 'grid grid-cols-1 md:grid-cols-3 lg:grid-cols-3 gap-4';

    // ×”×¦×’/×”×¡×ª×¨ ×”×•×“×¢×ª "×™×© ×œ×‘×—×•×¨ ×¢×¨×•×¥"
    message.classList.toggle('hidden', active.length > 0);

    active.forEach(key => {
      const ch = channels[key];
      const box = document.createElement('div');
      // ×”×•×¡×£ ×§×œ××¡ "active-fullscreen" ×× ×”×¢×¨×•×¥ ×‘××¦×‘ ××¡×š ××œ×
      box.className = `video-container ${fullscreenKey === key ? 'active-fullscreen' : ''}`;

      // ×”×•×¡×£ ×§×œ××¡ ×× ×™××¦×™×” ×‘×”×ª×× ×œ×›×™×•×•×Ÿ ×”×”×—×œ×§×” (×›× ×™×¡×” ×œ××¡×š ××œ×)
      if (fullscreenKey === key && lastDirection) {
        box.classList.add(lastDirection === 'right' ? 'slide-left' : 'slide-right');
      }

      let el; // ××œ×× ×˜ ×”×•×™×“××•/iframe
      const hasAudio = key === activeAudioKey; // ×”×× ×¢×¨×•×¥ ×–×” ×¢× ×©××¢ ×¤×¢×™×œ

      if (ch.type === 'hls') {
        // ×× ×–×” ×¢×¨×•×¥ HLS (×›××Ÿ 11, i24NEWS, ×—×“×©×•×ª 13)
        el = document.createElement('video');
        el.className = 'w-full h-full';
        el.autoplay = true;
        el.controls = true;
        el.muted = !hasAudio; // ×”×©×ª×§ ×× ××™×Ÿ ×œ×• ×©××¢ ×¤×¢×™×œ

        if (Hls.isSupported()) {
          // ×”×©×ª××© ×‘-Hls.js ×× × ×ª××š
          const hls = new Hls();
          hls.loadSource(ch.url);
          hls.attachMedia(el);
        } else {
          // ××—×¨×ª, ×”×©×ª××© ×‘× ×’×Ÿ ×”-HTML5 ×”××•×‘× ×”
          el.src = ch.url;
        }
      } else {
        // ×× ×–×” ×¢×¨×•×¥ iframe (×¢×›×©×™×• 14, ×—×“×©×•×ª 12)
        el = document.createElement('iframe');
        el.className = 'w-full h-full';
        el.allow = 'autoplay; fullscreen'; // ×”×¨×©××•×ª ×œ-iframe

        // ×”×©×ª××© ×‘-buildUrl ×œ×›×œ ×”××™×™×¤×¨×™×™× ×›×“×™ ×œ×©×œ×•×˜ ×‘×”×©×ª×§×”
        const muteParam = ch.muteParam || 'muted';
        el.src = buildUrl(ch.url, !hasAudio, muteParam);
      }

      // ×™×¦×™×¨×ª ×§×•× ×˜×™×™× ×¨ ×œ×›×¤×ª×•×¨×™ ×”×©×œ×™×˜×” (×©××¢ ×•××¡×š ××œ×)
      const controlsContainer = document.createElement('div');
      controlsContainer.className = 'controls-container';

      // ×™×¦×™×¨×ª ×¤×¡ ×©× ×”×¢×¨×•×¥
      const channelNameBar = document.createElement('div');
      channelNameBar.className = 'channel-name-bar';
      channelNameBar.textContent = ch.name; // ×©× ×”×¢×¨×•×¥ ××”××•×‘×™×™×§×˜ channels

      // ×›×¤×ª×•×¨ ×”×©×ª×§×”/×”×¤×¢×œ×” ×©×œ ×©××¢ - ×¨×§ ×¢×‘×•×¨ ×¢×¨×•×¦×™ HLS
      if (ch.type === 'hls') {
        const soundBtn = document.createElement('button');
        soundBtn.className = `sound-toggle ${hasAudio ? 'on' : 'off'}`;
        soundBtn.textContent = hasAudio ? 'ğŸ”Š ×”×©×ª×§' : 'ğŸ”‡ ×©××¢';
        soundBtn.onclick = e => {
          e.stopPropagation(); // ×× ×¢ ×”×ª×¤×©×˜×•×ª ×”××™×¨×•×¢
          activeAudioKey = hasAudio ? null : key; // ×©× ×” ××¦×‘ ×©××¢
          render(); // ×¨× ×“×¨ ××—×“×© ×›×“×™ ×œ×¢×“×›×Ÿ ××¦×‘ ×©××¢
          updateChannelButtons(); // ×¢×“×›×Ÿ ××™×™×§×•× ×™× ×‘×›×¤×ª×•×¨×™×
        };
        controlsContainer.append(soundBtn);
      }

      // ×›×¤×ª×•×¨ ××¡×š ××œ×
      const fullscreenBtn = document.createElement('button');
      fullscreenBtn.className = `fullscreen-toggle ${fullscreenKey === key ? 'active' : ''}`;
      fullscreenBtn.textContent = fullscreenKey === key ? 'â†©ï¸ ×—×–×¨×”' : 'â›¶ ××¡×š ××œ×';
      fullscreenBtn.onclick = e => {
        e.stopPropagation(); // ×× ×¢ ×”×ª×¤×©×˜×•×ª ×”××™×¨×•×¢
        toggleFullscreen(key); // ×”×¤×¢×œ/×›×‘×” ××¡×š ××œ×
      };

      // ×”×•×¡×£ ×›×¤×ª×•×¨×™× ×œ×§×•× ×˜×™×™× ×¨ ×”×©×œ×™×˜×”
      controlsContainer.append(fullscreenBtn); // ×›×¢×ª ×¨×§ ×›×¤×ª×•×¨ ×”××¡×š ×”××œ× ××• ×’× ×”×©××¢ ×¢×‘×•×¨ HLS
      // ×”×•×¡×£ ××ª ×”×•×™×“××•/iframe ×•××ª ×”×¤×§×“×™× ×œ×§×•×¤×¡×ª ×”×•×™×“××•
      box.append(el, controlsContainer, channelNameBar); // ×”×•×¡×£ ×’× ××ª ×¤×¡ ×©× ×”×¢×¨×•×¥
      // ×”×•×¡×£ ××ª ×§×•×¤×¡×ª ×”×•×™×“××• ×œ×¨×©×ª ×”×•×™×“××•
      grid.appendChild(box);
    });

    updateChannelButtons(); // ×¢×“×›×Ÿ ××ª ××¦×‘ ×›×¤×ª×•×¨×™ ×”×¢×¨×•×¦×™×
  }

  // ×”××–× ×” ×œ××™×¨×•×¢×™ ×™×¦×™××” ×××¡×š ××œ× ×©×œ ×”×“×¤×“×¤×Ÿ
  document.addEventListener('fullscreenchange', () => {
    if (!document.fullscreenElement && fullscreenKey) {
      // ×× ×™×¦×× ×• ×××¡×š ××œ× ×“×¨×š ×”×“×¤×“×¤×Ÿ (×œ×“×•×’××”, ×¢× ××§×© ESC), ×¢×“×›×Ÿ ××ª ×”××¦×‘ ×‘-JS
      toggleFullscreen(null);
    }
  });

  // × ×™×•×•×˜ ×‘××¦×‘ ××¡×š ××œ× ×‘×××¦×¢×•×ª ××§×©×™ ×—×¦×™×
  document.addEventListener('keydown', (e) => {
    if (!fullscreenKey) return; // ×¨×§ ×× ×× ×—× ×• ×‘××¦×‘ ××¡×š ××œ×

    const idx = active.indexOf(fullscreenKey); // ××™× ×“×§×¡ ×”×¢×¨×•×¥ ×”× ×•×›×—×™

    if (e.key === 'ArrowRight' && idx < active.length - 1) {
      // ×—×¥ ×™××™× ×”: ×¢×‘×•×¨ ×œ×¢×¨×•×¥ ×”×‘×
      lastDirection = 'right';
      fullscreenKey = active[idx + 1];
      activeAudioKey = fullscreenKey; // ×”×¢×¨×•×¥ ×”×—×“×© ×™×”×™×” ×¢× ×©××¢
      render();
    }
    if (e.key === 'ArrowLeft' && idx > 0) {
      // ×—×¥ ×©×××œ×”: ×¢×‘×•×¨ ×œ×¢×¨×•×¥ ×”×§×•×“×
      lastDirection = 'left';
      fullscreenKey = active[idx - 1];
      activeAudioKey = fullscreenKey; // ×”×¢×¨×•×¥ ×”×—×“×© ×™×”×™×” ×¢× ×©××¢
      render();
    }
  });

  // × ×™×•×•×˜ ×‘××¦×‘ ××¡×š ××œ× ×‘×××¦×¢×•×ª ××—×•×•×ª ××’×¢ (×¡×•×•×™×™×¤)
  let touchStartX = 0;
  document.addEventListener('touchstart', e => {
    if (e.touches.length === 1) {
      touchStartX = e.touches[0].clientX;
      // ×”×•×¡×£ ×§×œ××¡ ×œ×¤×¢×™×œ×•×ª ××’×¢ ×›×“×™ ×œ×”×¦×™×’ ×¤×§×“×™× ×‘××›×©×™×¨×™ ××’×¢
      e.target.closest('.video-container')?.classList.add('touch-active');
    }
  });
  document.addEventListener('touchend', e => {
    if (!fullscreenKey || e.changedTouches.length !== 1) return;

    const diffX = e.changedTouches[0].clientX - touchStartX;
    const idx = active.indexOf(fullscreenKey);

    if (diffX < -50 && idx < active.length - 1) {
      // ×¡×•×•×™×™×¤ ×©×××œ×”: ×¢×‘×•×¨ ×œ×¢×¨×•×¥ ×”×‘×
      lastDirection = 'right';
      fullscreenKey = active[idx + 1];
      activeAudioKey = fullscreenKey;
      render();
    }
    if (diffX > 50 && idx > 0) {
      // ×¡×•×•×™×™×¤ ×™××™× ×”: ×¢×‘×•×¨ ×œ×¢×¨×•×¥ ×”×§×•×“×
      lastDirection = 'left';
      fullscreenKey = active[idx - 1];
      activeAudioKey = fullscreenKey;
      render();
    }
    // ×”×¡×¨ ××ª ×”×§×œ××¡ touch-active ×œ××—×¨ ××™× ×˜×¨××§×¦×™×”
    e.target.closest('.video-container')?.classList.remove('touch-active');
  });

  // × ×™×•×•×˜ ×‘××¦×‘ ××¡×š ××œ× ×‘×××¦×¢×•×ª ×’×¨×™×¨×” ×¢× ×”×¢×›×‘×¨
  let mouseDownX = null;
  document.addEventListener('mousedown', e => {
    if (fullscreenKey) mouseDownX = e.clientX;
  });
  document.addEventListener('mouseup', e => {
    if (!fullscreenKey || mouseDownX === null) return;

    const diffX = e.clientX - mouseDownX;
    const idx = active.indexOf(fullscreenKey);

    if (diffX < -100 && idx < active.length - 1) {
      // ×’×¨×™×¨×” ×©×××œ×”: ×¢×‘×•×¨ ×œ×¢×¨×•×¥ ×”×‘×
      lastDirection = 'right';
      fullscreenKey = active[idx + 1];
      activeAudioKey = fullscreenKey;
      render();
    }
    if (diffX > 100 && idx > 0) {
      // ×’×¨×™×¨×” ×™××™× ×”: ×¢×‘×•×¨ ×œ×¢×¨×•×¥ ×”×§×•×“×
      lastDirection = 'left';
      fullscreenKey = active[idx - 1];
      activeAudioKey = fullscreenKey;
      render();
    }
    mouseDownX = null;
  });

  // ×˜×™×¤×•×œ ×‘×œ×—×™×¦×” ×¢×œ ×›×¤×ª×•×¨×™ ×”×¢×¨×•×¦×™×
  document.querySelectorAll('.channel-button').forEach(btn => {
    const key = btn.dataset.channel;
    btn.onclick = () => {
      if (active.includes(key)) {
        // ×× ×”×¢×¨×•×¥ ×›×‘×¨ ×¤×¢×™×œ, ×”×¡×¨ ××•×ª×•
        active = active.filter(k => k !== key);
        if (activeAudioKey === key) activeAudioKey = null; // ×× ×”×¡×¨× ×• ××ª ×”×¢×¨×•×¥ ×¢× ×”×©××¢, × ×§×”
        if (fullscreenKey === key) toggleFullscreen(null); // ×× ×”×¡×¨× ×• ××ª ×”×¢×¨×•×¥ ×‘××¡×š ××œ×, ×¦× ×××¡×š ××œ×
        btn.classList.remove('active'); // ×”×¡×¨ ×¡×™××•×Ÿ ×¤×¢×™×œ ××”×›×¤×ª×•×¨
      } else {
        // ×× ×”×¢×¨×•×¥ ×œ× ×¤×¢×™×œ, ×”×•×¡×£ ××•×ª×• (×‘××§×•× ×”×¨××©×•×Ÿ ×‘×¨×©×™××”)
        active.unshift(key);
        btn.classList.add('active'); // ×¡××Ÿ ××ª ×”×›×¤×ª×•×¨ ×›×¤×¢×™×œ
      }
      render(); // ×¨× ×“×¨ ××—×“×© ××ª ×”×¨×©×ª
    };
  });

  // ×§×¨×™××” ×¨××©×•× ×™×ª ×œ-render ×›×“×™ ×œ×”×¦×™×’ ××ª ××¦×‘ ×”×”×ª×—×œ×ª×™ (×”×•×“×¢×ª "×™×© ×œ×‘×—×•×¨ ×¢×¨×•×¥")
  render();
</script>

<footer class="mt-10 text-center text-sm text-gray-400">
  <!-- ×”×›×¤×ª×•×¨ ×œ×¦×¤×™×™×” ×‘××¡×š ×’×“×•×œ (×›× ×¨××” ×œ× ×‘×©×™××•×© ×›×¢×ª, ××›×™×•×•×Ÿ ×©×™×© ×›×¤×ª×•×¨ ××¡×š ××œ× ×‘×›×œ ×•×™×“××•) -->
  <button id="fullscreen-toggle" class="footer-link-button mt-2 hidden">×¦×¤×™×™×” ×‘××¡×š ×’×“×•×œ</button>
  <div class="mb-2">×’× ×ª×—× ×•×ª ×¨×“×™×• ×œ×”××–× ×”:</div>
  <a href="https://mistralnet.github.io/radio" class="inline-block bg-indigo-600 hover:bg-indigo-500 text-white py-2 px-4 rounded mb-4">ğŸ§ ×ª×—× ×•×ª ×¨×“×™×•</a>
  <div class="flex justify-center gap-4 flex-wrap mb-4">
    <a href="https://mistralnet.github.io/radio/" class="text-blue-400 hover:text-blue-300">Radio</a>
    <a href="https://mistralnet.github.io/radio/tv.html" class="text-blue-400 hover:text-blue-300">TV</a>
    <a href="https://mistralnet.github.io/radio/tv2.html" class="text-blue-400 hover:text-blue-300">TV2</a>
    <a href="https://mistralnet.github.io/radio/tv3.html" class="text-blue-400 hover:text-blue-300">TV3</a>
    <a href="https://mistralnet.github.io/radio/tv4.html" class="text-blue-400 hover:text-blue-300">TV4</a>
  </div>
  <div class="version-info">×’×¨×¡×” 6.4 - ×¢× × ×™×•×•×˜ ×‘×™×Ÿ ×¢×¨×•×¦×™× ×‘××¡×š ××œ× ×•×¢×™×¦×•×‘ ×›×¤×ª×•×¨×™× ×©×××œ×™</div>
</footer>
</body>
</html>
