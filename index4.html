<!DOCTYPE html>
<html lang="he">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>נגן רדיו</title>
</head>
<body>
    <h2>נגן רדיו</h2>
    <audio id="radio" controls>
        <source src="https://stream.live.vc.bbcmedia.co.uk/bbc_world_service" type="audio/mpeg">
        הדפדפן שלך אינו תומך באודיו.
    </audio>
    <br>
    <button onclick="getAudioDevices()">בחר התקן שמע</button>
    <select id="audioDevices" onchange="changeAudioOutput()"></select>

    <script>
        async function getAudioDevices() {
            try {
                const devices = await navigator.mediaDevices.enumerateDevices();
                const audioOutputs = devices.filter(device => device.kind === 'audiooutput');
                const select = document.getElementById('audioDevices');
                select.innerHTML = '';
                if (audioOutputs.length === 0) {
                    alert('לא נמצאו התקני שמע זמינים.');
                    return;
                }
                audioOutputs.forEach(device => {
                    const option = document.createElement('option');
                    option.value = device.deviceId;
                    option.textContent = device.label || `התקן ${select.length + 1}`;
                    select.appendChild(option);
                });
            } catch (error) {
                console.error('שגיאה בקבלת התקני שמע:', error);
                alert('לא ניתן לגשת לרשימת התקני שמע. ודא שהדפדפן מאפשר זאת.');
            }
        }

        function changeAudioOutput() {
            const audio = document.getElementById('radio');
            const selectedDevice = document.getElementById('audioDevices').value;
            if (audio.setSinkId) {
                audio.setSinkId(selectedDevice)
                    .then(() => console.log('התקן שמע שונה בהצלחה'))
                    .catch(error => console.error('שגיאה בשינוי התקן שמע:', error));
            } else {
                alert('הדפדפן שלך אינו תומך בבחירת התקני שמע.');
            }
        }
    </script>
</body>
</html>
